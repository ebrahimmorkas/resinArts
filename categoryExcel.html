<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Category Bulk Upload Excel Structure</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 20px;
            background-color: #f5f7fa;
        }
        .container {
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            padding: 30px;
            max-width: 100%;
            overflow-x: auto;
        }
        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 30px;
            font-size: 28px;
        }
        h2 {
            color: #34495e;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
            margin-top: 30px;
        }
        h3 {
            color: #27ae60;
            margin-top: 25px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            font-size: 13px;
        }
        th {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px 10px;
            text-align: center;
            font-weight: 600;
            border: 1px solid #ddd;
        }
        td {
            padding: 12px 10px;
            border: 1px solid #ddd;
            text-align: center;
            vertical-align: middle;
        }
        .level-0 { background-color: #ffebee; }
        .level-1 { background-color: #e8f5e8; }
        .level-2 { background-color: #e3f2fd; }
        .level-3 { background-color: #fff3e0; }
        .level-4 { background-color: #f3e5f5; }
        
        .note {
            background-color: #e8f5e8;
            border-left: 4px solid #4caf50;
            padding: 15px;
            margin: 20px 0;
            border-radius: 4px;
        }
        .warning {
            background-color: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin: 20px 0;
            border-radius: 4px;
        }
        .important {
            background-color: #ffebee;
            border-left: 4px solid #f44336;
            padding: 15px;
            margin: 20px 0;
            border-radius: 4px;
        }
        .code {
            font-family: 'Courier New', monospace;
            background-color: #f8f9fa;
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 12px;
        }
        .hierarchy-visual {
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            line-height: 1.8;
        }
        .indent-1 { margin-left: 20px; }
        .indent-2 { margin-left: 40px; }
        .indent-3 { margin-left: 60px; }
        .indent-4 { margin-left: 80px; }
    </style>
</head>
<body>
    <div class="container">
        <h1>Excel Structure for Bulk Category Upload</h1>
        
        <div class="important">
            <h3>üéØ Key Strategy: Path-Based Approach</h3>
            <p>Use hierarchical paths to represent nested categories. The backend will process these paths to create parent-child relationships automatically.</p>
        </div>

        <h2>Method 1: Path-Based Structure (Recommended)</h2>
        
        <table>
            <thead>
                <tr>
                    <th>categoryPath</th>
                    <th>categoryName</th>
                    <th>image</th>
                    <th>level</th>
                    <th>description</th>
                </tr>
            </thead>
            <tbody>
                <tr class="level-0">
                    <td>Electronics</td>
                    <td>Electronics</td>
                    <td>https://res.cloudinary.com/djn2jtaez/image/upload/v123/electronics.jpg</td>
                    <td>0</td>
                    <td>Main electronics category</td>
                </tr>
                <tr class="level-1">
                    <td>Electronics > Mobile</td>
                    <td>Mobile</td>
                    <td>https://res.cloudinary.com/djn2jtaez/image/upload/v123/mobile.jpg</td>
                    <td>1</td>
                    <td>Mobile phones category</td>
                </tr>
                <tr class="level-1">
                    <td>Electronics > Laptop</td>
                    <td>Laptop</td>
                    <td>https://res.cloudinary.com/djn2jtaez/image/upload/v123/laptop.jpg</td>
                    <td>1</td>
                    <td>Laptop computers category</td>
                </tr>
                <tr class="level-2">
                    <td>Electronics > Mobile > Vivo</td>
                    <td>Vivo</td>
                    <td>https://res.cloudinary.com/djn2jtaez/image/upload/v123/vivo.jpg</td>
                    <td>2</td>
                    <td>Vivo mobile brand</td>
                </tr>
                <tr class="level-2">
                    <td>Electronics > Mobile > Oppo</td>
                    <td>Oppo</td>
                    <td>https://res.cloudinary.com/djn2jtaez/image/upload/v123/oppo.jpg</td>
                    <td>2</td>
                    <td>Oppo mobile brand</td>
                </tr>
                <tr class="level-2">
                    <td>Electronics > Laptop > HP</td>
                    <td>HP</td>
                    <td>https://res.cloudinary.com/djn2jtaez/image/upload/v123/hp.jpg</td>
                    <td>2</td>
                    <td>HP laptop brand</td>
                </tr>
                <tr class="level-2">
                    <td>Electronics > Laptop > Dell</td>
                    <td>Dell</td>
                    <td>https://res.cloudinary.com/djn2jtaez/image/upload/v123/dell.jpg</td>
                    <td>2</td>
                    <td>Dell laptop brand</td>
                </tr>
                <tr class="level-3">
                    <td>Electronics > Mobile > Vivo > V11</td>
                    <td>V11</td>
                    <td></td>
                    <td>3</td>
                    <td>Vivo V11 series</td>
                </tr>
                <tr class="level-3">
                    <td>Electronics > Mobile > Oppo > O11</td>
                    <td>O11</td>
                    <td></td>
                    <td>3</td>
                    <td>Oppo O11 series</td>
                </tr>
                <tr class="level-3">
                    <td>Electronics > Laptop > HP > Pavilion</td>
                    <td>Pavilion</td>
                    <td></td>
                    <td>3</td>
                    <td>HP Pavilion series</td>
                </tr>
                <tr class="level-3">
                    <td>Electronics > Laptop > Dell > Inspiron</td>
                    <td>Inspiron</td>
                    <td></td>
                    <td>3</td>
                    <td>Dell Inspiron series</td>
                </tr>
            </tbody>
        </table>

        <h2>Method 2: Parent Reference Structure</h2>
        
        <table>
            <thead>
                <tr>
                    <th>categoryName</th>
                    <th>parentCategoryName</th>
                    <th>image</th>
                    <th>sortOrder</th>
                </tr>
            </thead>
            <tbody>
                <tr class="level-0">
                    <td>Electronics</td>
                    <td></td>
                    <td>https://res.cloudinary.com/djn2jtaez/image/upload/v123/electronics.jpg</td>
                    <td>1</td>
                </tr>
                <tr class="level-1">
                    <td>Mobile</td>
                    <td>Electronics</td>
                    <td>https://res.cloudinary.com/djn2jtaez/image/upload/v123/mobile.jpg</td>
                    <td>1</td>
                </tr>
                <tr class="level-1">
                    <td>Laptop</td>
                    <td>Electronics</td>
                    <td>https://res.cloudinary.com/djn2jtaez/image/upload/v123/laptop.jpg</td>
                    <td>2</td>
                </tr>
                <tr class="level-2">
                    <td>Vivo</td>
                    <td>Mobile</td>
                    <td>https://res.cloudinary.com/djn2jtaez/image/upload/v123/vivo.jpg</td>
                    <td>1</td>
                </tr>
                <tr class="level-2">
                    <td>Oppo</td>
                    <td>Mobile</td>
                    <td>https://res.cloudinary.com/djn2jtaez/image/upload/v123/oppo.jpg</td>
                    <td>2</td>
                </tr>
                <tr class="level-3">
                    <td>V11</td>
                    <td>Vivo</td>
                    <td></td>
                    <td>1</td>
                </tr>
                <tr class="level-3">
                    <td>O11</td>
                    <td>Oppo</td>
                    <td></td>
                    <td>1</td>
                </tr>
            </tbody>
        </table>

        <div class="hierarchy-visual">
            <strong>Visual Hierarchy Representation:</strong><br><br>
            üìÅ Electronics<br>
            <span class="indent-1">üìÅ Mobile</span><br>
            <span class="indent-2">üìÅ Vivo</span><br>
            <span class="indent-3">üì± V11</span><br>
            <span class="indent-2">üìÅ Oppo</span><br>
            <span class="indent-3">üì± O11</span><br>
            <span class="indent-1">üìÅ Laptop</span><br>
            <span class="indent-2">üíª HP</span><br>
            <span class="indent-3">üíª Pavilion</span><br>
            <span class="indent-2">üíª Dell</span><br>
            <span class="indent-3">üíª Inspiron</span><br>
        </div>

        <h2>Processing Logic for Backend</h2>

        <div class="note">
            <h3>üîÑ Path-Based Processing (Method 1):</h3>
            <ol>
                <li><strong>Parse Path:</strong> Split <span class="code">Electronics > Mobile > Vivo > V11</span> by <span class="code"> > </span></li>
                <li><strong>Process Hierarchically:</strong>
                    <ul>
                        <li>Check if "Electronics" exists, if not create it with <span class="code">parent_category_id: null</span></li>
                        <li>Check if "Mobile" exists under "Electronics", if not create it</li>
                        <li>Check if "Vivo" exists under "Mobile", if not create it</li>
                        <li>Check if "V11" exists under "Vivo", if not create it</li>
                    </ul>
                </li>
                <li><strong>Link Relations:</strong> Each level gets the ObjectId of its parent</li>
            </ol>
        </div>

        <div class="note">
            <h3>üîó Parent Reference Processing (Method 2):</h3>
            <ol>
                <li><strong>Sort by Dependency:</strong> Process parents before children</li>
                <li><strong>Create Root Categories:</strong> Categories with empty <span class="code">parentCategoryName</span></li>
                <li><strong>Resolve References:</strong> Find parent ObjectId by <span class="code">parentCategoryName</span></li>
                <li><strong>Handle Missing Parents:</strong> Skip or create placeholder if parent doesn't exist</li>
            </ol>
        </div>

        <h2>Additional Excel Sheets (Optional)</h2>

        <h3>Sheet 2: Category Metadata</h3>
        <table>
            <thead>
                <tr>
                    <th>categoryName</th>
                    <th>isActive</th>
                    <th>displayOrder</th>
                    <th>metaTitle</th>
                    <th>metaDescription</th>
                    <th>slug</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Electronics</td>
                    <td>TRUE</td>
                    <td>1</td>
                    <td>Electronics - Best Deals</td>
                    <td>Shop latest electronics</td>
                    <td>electronics</td>
                </tr>
                <tr>
                    <td>Mobile</td>
                    <td>TRUE</td>
                    <td>1</td>
                    <td>Mobile Phones</td>
                    <td>Latest smartphones</td>
                    <td>mobile-phones</td>
                </tr>
            </tbody>
        </table>

        <div class="warning">
            <h3>‚ö†Ô∏è Important Considerations:</h3>
            <ul>
                <li><strong>Processing Order:</strong> Method 1 handles order automatically. Method 2 requires careful sorting.</li>
                <li><strong>Duplicate Handling:</strong> Check existing categories before creating new ones</li>
                <li><strong>Path Separator:</strong> Use consistent separator (e.g., <span class="code"> > </span>) in Method 1</li>
                <li><strong>Image Upload:</strong> Pre-upload images to Cloudinary or use placeholder URLs</li>
                <li><strong>Error Handling:</strong> Log failed category creations for manual review</li>
            </ul>
        </div>

        <div class="important">
            <h3>üöÄ Recommended Implementation Steps:</h3>
            <ol>
                <li><strong>Choose Method 1 (Path-Based)</strong> - easier to understand and process</li>
                <li><strong>Sort Excel by level</strong> - process level 0, then 1, then 2, etc.</li>
                <li><strong>Implement dry-run mode</strong> - validate structure before actual creation</li>
                <li><strong>Create mapping table</strong> - track created category ObjectIds for reference</li>
                <li><strong>Generate category paths</strong> - for product import later</li>
            </ol>
        </div>

        <h3>Sample Backend Processing Pseudocode:</h3>
        <div class="hierarchy-visual">
<strong>// Method 1 Processing</strong><br>
for each row in excel:<br>
<span class="indent-1">path = row.categoryPath.split(' > ')</span><br>
<span class="indent-1">currentParent = null</span><br>
<span class="indent-1">for each segment in path:</span><br>
<span class="indent-2">existingCategory = findCategory(segment, currentParent)</span><br>
<span class="indent-2">if (!existingCategory):</span><br>
<span class="indent-3">newCategory = createCategory({</span><br>
<span class="indent-4">categoryName: segment,</span><br>
<span class="indent-4">parent_category_id: currentParent,</span><br>
<span class="indent-4">image: getImageForCategory(segment)</span><br>
<span class="indent-3">})</span><br>
<span class="indent-3">currentParent = newCategory._id</span><br>
<span class="indent-2">else:</span><br>
<span class="indent-3">currentParent = existingCategory._id</span>
        </div>
    </div>
</body>
</html>